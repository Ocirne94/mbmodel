for (cell_cur_id_id in 1:length(elevation_sorted_ids)) {
  
  cat(cell_cur_id_id, "/", length(elevation_sorted_ids), "\n")
  
  cell_cur_id <- elevation_sorted_ids[cell_cur_id_id]
  
  cell_adjacent_id1 <- cell_cur_id - grid_ncol
  cell_adjacent_id2 <- cell_cur_id - 1
  cell_adjacent_id3 <- cell_cur_id + 1
  cell_adjacent_id4 <- cell_cur_id + grid_ncol
  
  deposition[cell_cur_id] <- min(deposition_max[cell_cur_id], mass_movable[cell_cur_id]) # Eq. 1 in Gruber (2007).
  flow1 <- (mass_movable[cell_cur_id] - deposition[cell_cur_id]) * draining_fraction1[cell_cur_id] # Eq. 2 in Gruber (2007).
  flow2 <- (mass_movable[cell_cur_id] - deposition[cell_cur_id]) * draining_fraction2[cell_cur_id]
  flow3 <- (mass_movable[cell_cur_id] - deposition[cell_cur_id]) * draining_fraction3[cell_cur_id]
  flow4 <- (mass_movable[cell_cur_id] - deposition[cell_cur_id]) * draining_fraction4[cell_cur_id]
  
  mass_movable[cell_adjacent_id1] <- mass_movable[cell_adjacent_id1] + flow1
  mass_movable[cell_adjacent_id2] <- mass_movable[cell_adjacent_id2] + flow2
  mass_movable[cell_adjacent_id3] <- mass_movable[cell_adjacent_id3] + flow3
  mass_movable[cell_adjacent_id4] <- mass_movable[cell_adjacent_id4] + flow4
  
} 
